---
title: "04.2_vulnerability_index_AE"
author: "Puvvula"
date: "2024-04-25"
output: pdf_document
---

#load SDOH data
```{r}
load("~/Documents/extreme_heat_cc/data/SDOH_final.RDA")
```

#select required variables to work
```{r}
index_df<- dat_fin |>
  as_tibble()|>
  select(c(4, 16:27)) |>
  rename(`Non-Hispanic Black` = blk_pct,
         Hispanic = hisp_pct,
         Asian = asin_pct,
         `Alaska/Pacific-Islander` = alask_pacf_isl_pct,
         `Health insurance` = ins_pct,
         `Federal assistance` =ssi_snap_pct,
         `Households in poverty` = poverty_pct,
         `Un-employment` = un_empl_pct,
         `Language barrier` = langu_pct,
         `Single parent` =sing_prnt_pct,
         `Foregin born` = foregin_born_pct,
         `Access to vechilce` = no_vehic
         )
```

#scaling data
```{r}
model_df<- index_df |>
  select(-c(1,5,9))

#scaling function
minmax <- function(x) (x - min(x))/(max(x) - min(x))

#setting training data
x_train <- as.matrix(apply(model_df[,1:10], 2, minmax))

# set model
model <- keras_model_sequential(input_shape = c(500))
model |>
  layer_dense(units = 6, activation = "tanh", input_shape = ncol(x_train)) |>
  layer_dense(units = 2, activation = "tanh", name = "bottleneck") |>
  layer_dense(units = 6, activation = "tanh") |>
  layer_dense(units = ncol(x_train))
```


